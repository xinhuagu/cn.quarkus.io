<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - Deploying on OpenShift - 1.11</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="default-src https://dpm.demdex.net; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com https://static.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com https://app.mailjet.com http://www.youtube.com http://www.googleadservices.com https://googleads.g.doubleclick.net https://dpm.demdex.net https://giscus.app; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self'; frame-src https://www.googletagmanager.com https://www.youtube.com https://embed.restream.io https://app.mailjet.com https://giscus.app; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/1.11/guides/deploying-to-openshift" />
  <meta property="og:title" content="Quarkus - Deploying on OpenShift - 1.11" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/deploying-to-openshift">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  

<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
    </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">关于<i class="fas fa-chevron-down">
</i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUS是什么？</a></li>
          <li><a href="/container-first" class="">容器优先 </a></li>
          <li><a href="/continuum" class="">响应式</a></li>
          <li><a href="/developer-joy" class="">开发者的乐趣 </a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES 原生</a></li>
          <li><a href="/standards" class="">标准</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">学习 <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入门</a></li>
          <li><a href="/guides" class="active" >指南</a></li>
          <li><a href="/qtips" class="">"Q" TIP视频</a></li>          
          <li><a href="/books" class="">书籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">社区 <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">支持</a></li>
          <li><a href="/blog" class="" >博客</a></li>
          <li><a href="/discussion" class="">讨论</a></li>
          <li><a href="/insights" class="" >播客</a></li>
          <li><a href="/events" class="">活动</a></li>
          <li><a href="/newsletter" class="">新闻</a></li>
          <li><a href="/publications" class="">发表</a></li>
          <li><a href="/awards" class="">获奖</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">开始写代码</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://es.quarkus.io/">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/">日本語</a></li>
          </ul>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    



<div class="full-width-version-bg grey align-self">
  <div class="grid-wrapper">
    <div class="grid__item width-6-12">
      <p class="returnlink"><i class="fas fa-angle-left"></i><a href="/version/1.11/guides/">返回指南目录</a></p>
    </div>
    <div class="grid__item width-6-12 align-self-center text-right hide-mobile">
      <label id="guide-version-label">选择指南版本</label>
      <select id="guide-version-dropdown">
        
      
        
        
        
        
          
        <option value="main" >Main - SNAPSHOT</option>
        
        
      
        
        
        
        
      
        
        
        
        
          
        <option value="2.7" >2.7</option>
        
        
      
        
        
        
        
          
        <option value="2.2" >2.2</option>
        
        
      
        
        
        
        
          
        <option value="1.11" selected>1.11</option>
        
        
      
    
      </select>
    </div>
  </div>
</div>

<div class="grid-wrapper guide">
  <div class="grid__item width-12-12 width-12-12-mobile">
    <h1 class="text-caps">Quarkus - Deploying on OpenShift </h1>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#先决条件">先决条件</a></li>
<li><a href="#创建maven项目">创建Maven项目</a>
<ul class="sectlevel2">
<li><a href="#openshift">OpenShift</a></li>
<li><a href="#build-and-deploy-in-separate-steps">Build and Deploy (in separate steps)</a></li>
<li><a href="#non-s2i-builds">Non S2i Builds</a></li>
<li><a href="#build-and-deploy-in-a-single-step">Build and Deploy (in a single step)</a></li>
<li><a href="#customizing">Customizing</a></li>
<li><a href="#knative-openshift-serverless">Knative - OpenShift Serverless</a></li>
</ul>
</li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide covers generating and deploying OpenShift resources based on sane default and user supplied configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="先决条件"><a class="anchor" href="#先决条件"></a>先决条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>要完成这个指南，你需要：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>roughly 5 minutes</p>
</li>
<li>
<p>一个编辑器</p>
</li>
<li>
<p>JDK 1.8+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>Apache Maven 3.6.2+</p>
</li>
<li>
<p>access to an OpenShift cluster (Minishift is a viable option)</p>
</li>
<li>
<p>OpenShift CLI (Optional. Only required for manually deploying)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="创建maven项目"><a class="anchor" href="#创建maven项目"></a>创建Maven项目</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we need a new project that contains the OpenShift extension. This can be done using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus:quarkus-maven-plugin:1.11.7.Final:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=openshift-quickstart \
    -DclassName="org.acme.rest.GreetingResource" \
    -Dpath="/greeting" \
    -Dextensions="resteasy,openshift"

cd openshift-quickstart</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="openshift"><a class="anchor" href="#openshift"></a>OpenShift</h3>
<div class="paragraph">
<p>Quarkus offers the ability to automatically generate OpenShift resources based on sane default and user supplied configuration. The OpenShift extension is actually a wrapper extension that brings together the <a href="deploying-to-kubernetes">kubernetes</a> and <a href="container-image#s2i">container-image-s2i</a> extensions with sensible defaults so that it&#8217;s easier for the user to get started with Quarkus on OpenShift.</p>
</div>
<div class="paragraph">
<p>When we added the OpenShift extension to the command line invocation above, the following dependency was added to the <code>pom.xml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-openshift&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>By adding this dependency, we now have the ability to configure the OpenShift resource generation and application using the usual <code>application.properties</code> approach that Quarkus provides. The configuration items that are available can be found in: <code>io.quarkus.kubernetes.deployment.OpenShiftConfig</code> class. Furthermore, the items provided by <code>io.quarkus.deployment.ApplicationConfig</code> affect the OpenShift resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="build-and-deploy-in-separate-steps"><a class="anchor" href="#build-and-deploy-in-separate-steps"></a>Build and Deploy (in separate steps)</h3>
<div class="paragraph">
<p>If the OpenShift extension was not included during the bootstraping of the project nor was it added subsequently (check pom.xml file for it), then it can be added like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> ./mvnw quarkus:add-extension -Dextensions="openshift"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Building is handled by the <a href="container-image#s2i">container-image-s2i</a> extension. To trigger a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw clean package -Dquarkus.container-image.build=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The build that will be performed is an s2i binary build. The input of the build is the jar that has been built locally and the output of the build is an ImageStream that is configured to automatically trigger a deployment.</p>
</div>
<div class="paragraph">
<p>To deploy the container image created in the above step to OpenShift, follow these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get is
oc new-app --name=greeting &lt;project&gt;/openshift-quickstart:1.0.0-SNAPSHOT
oc get svc
oc expose svc/greeting
oc get routes
curl http://&lt;route&gt;/greeting</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, <code>oc get is</code> will list the image stream created. It should be tagged as &lt;project&gt;/openshift-quickstart:1.0.0-SNAPSHOT.</p>
</div>
<div class="paragraph">
<p>Similarly, <code>oc get route</code> will list the route URL for the exposed service "greeting" so that you can use it to test the application.</p>
</div>
</div>
<div class="sect2">
<h3 id="non-s2i-builds"><a class="anchor" href="#non-s2i-builds"></a>Non S2i Builds</h3>
<div class="paragraph">
<p>Out of the box the openshift extension is configured to use <a href="container-image#s2i">container-image-s2i</a>. However, it&#8217;s still possible to use other container image extensions like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="container-image#s2i">container-image-docker</a></p>
</li>
<li>
<p><a href="container-image#s2i">container-image-jib</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a non-s2i container image extension is used, an ImageStream is created that is pointing to an external <code>dockerImageRepository</code>. The image is built and pushed to the registry and the ImageStream populates the tags that are available in the <code>dockerImageRepository</code>.</p>
</div>
<div class="paragraph">
<p>To select which extension will be used for building the image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.container-image.builder=docker</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.container-image.builder=jib</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="build-and-deploy-in-a-single-step"><a class="anchor" href="#build-and-deploy-in-a-single-step"></a>Build and Deploy (in a single step)</h3>
<div class="paragraph">
<p>If the OpenShift extension was not included during the bootstraping of the project nor was it added subsequently (check pom.xml file for it), then it can be added like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> ./mvnw quarkus:add-extension -Dextensions="openshift"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To trigger a build and deployment in a single step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw clean package -Dquarkus.kubernetes.deploy=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The aforementioned command will build a jar file locally, trigger a container image build and then apply the generated OpenShift resources. The generated resources are using OpenShift&#8217;s <code>DeploymentConfig</code> that is configured to automatically trigger a redeployment when a change in the <code>ImageStream</code> is noticed. In other words, any container image build after the initial deployment will automatically trigger redeployment, without the need to delete, update or re-apply the generated resources.</p>
</div>
<div class="paragraph">
<p>To confirm the above command has created an image stream, a service resource and has deployed the application (has a pod running), apply these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get is
oc get pods
oc get svc</code></pre>
</div>
</div>
<div class="paragraph">
<p>To expose the created service to a route and test it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc expose svc/greeting
oc get routes
curl http://&lt;route&gt;/greeting</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="customizing"><a class="anchor" href="#customizing"></a>Customizing</h3>
<div class="paragraph">
<p>All available customization options are available in the <a href="deploying-to-kubernetes#openshift">OpenShift configuration options</a>.</p>
</div>
<div class="paragraph">
<p>Some examples are provided in the sections below:</p>
</div>
<div class="sect3">
<h4 id="exposing-routes"><a class="anchor" href="#exposing-routes"></a>Exposing Routes</h4>
<div class="paragraph">
<p>To expose a <code>Route</code> for the Quarkus application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.expose=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tip: You don&#8217;t necessarily need to add this property in the <code>application.properties</code>. You can pass it as a command line argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw clean package -Dquarkus.openshift.expose=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same applies to all properties listed below.</p>
</div>
</div>
<div class="sect3">
<h4 id="labels"><a class="anchor" href="#labels"></a>Labels</h4>
<div class="paragraph">
<p>To add a label in the generated resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.labels.foo=bar</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="annotations"><a class="anchor" href="#annotations"></a>Annotations</h4>
<div class="paragraph">
<p>To add an annotation in the generated resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.annotations.foo=bar</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="env-vars"><a class="anchor" href="#env-vars"></a>Environment variables</h4>
<div class="paragraph">
<p>OpenShift provides multiple ways of defining environment variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>key/value pairs</p>
</li>
<li>
<p>import all values from a Secret or ConfigMap</p>
</li>
<li>
<p>interpolate a single value identified by a given field in a Secret or ConfigMap</p>
</li>
<li>
<p>interpolate a value from a field within the same resource</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="environment-variables-from-keyvalue-pairs"><a class="anchor" href="#environment-variables-from-keyvalue-pairs"></a>Environment variables from key/value pairs</h5>
<div class="paragraph">
<p>To add a key/value pair as an environment variable in the generated resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.vars.my-env-var=foobar</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command above will add <code>MY_ENV_VAR=foobar</code> as an environment variable. Please note that the key <code>my-env-var</code> will be converted to uppercase and dashes will be replaced by underscores resulting in <code>MY_ENV_VAR</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="environment-variables-from-secret"><a class="anchor" href="#environment-variables-from-secret"></a>Environment variables from Secret</h5>
<div class="paragraph">
<p>To add all key/value pairs of <code>Secret</code> as environment variables just apply the following configuration, separating each <code>Secret</code> to be used as source by a comma (<code>,</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.secrets=my-secret,my-other-secret</code></pre>
</div>
</div>
<div class="paragraph">
<p>which would generate the following in the container definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">envFrom:
  - secretRef:
      name: my-secret
      optional: false
  - secretRef:
      name: my-other-secret
      optional: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following extracts a value identified by the <code>keyName</code> field from the <code>my-secret</code> Secret into a <code>foo</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.mapping.foo.from-secret=my-secret
quarkus.openshift.env.mapping.foo.with-key=keyName</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would generate the following in the <code>env</code> section of your container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- env:
  - name: FOO
    valueFrom:
      secretKeyRef:
        key: keyName
        name: my-secret
        optional: false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="environment-variables-from-configmap"><a class="anchor" href="#environment-variables-from-configmap"></a>Environment variables from ConfigMap</h5>
<div class="paragraph">
<p>To add all key/value pairs from <code>ConfigMap</code> as environment variables just apply the following configuration, separating each <code>ConfigMap</code> to be used as source by a comma (<code>,</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.configmaps=my-config-map,another-config-map</code></pre>
</div>
</div>
<div class="paragraph">
<p>which would generate the following in the container definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">envFrom:
  - configMapRef:
      name: my-config-map
      optional: false
  - configMapRef:
      name: another-config-map
      optional: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following extracts a value identified by the <code>keyName</code> field from the <code>my-config-map</code> ConfigMap into a <code>foo</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.mapping.foo.from-configmap=my-configmap
quarkus.openshift.env.mapping.foo.with-key=keyName</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would generate the following in the <code>env</code> section of your container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- env:
  - name: FOO
    valueFrom:
      configMapRefKey:
        key: keyName
        name: my-configmap
        optional: false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="environment-variables-from-fields"><a class="anchor" href="#environment-variables-from-fields"></a>Environment variables from fields</h5>
<div class="paragraph">
<p>It&#8217;s also possible to use the value from another field to add a new environment variable by specifying the path of the field to be used as a source, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.fields.foo=metadata.name</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="validation"><a class="anchor" href="#validation"></a>Validation</h5>
<div class="paragraph">
<p>A conflict between two definitions, e.g. mistakenly assigning both a value and specifying that a variable is derived from a field, will result in an error being thrown at build time so that you get the opportunity to fix the issue before you deploy your application to your cluster where it might be more difficult to diagnose the source of the issue.</p>
</div>
<div class="paragraph">
<p>Similarly, two redundant definitions, e.g. defining an injection from the same secret twice, will not cause an issue but will indeed report a warning to let you know that you might not have intended to duplicate that definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="env-vars-backwards"><a class="anchor" href="#env-vars-backwards"></a>Backwards compatibility</h5>
<div class="paragraph">
<p>Previous versions of the OpenShift extension supported a different syntax to add environment variables. The older syntax is still supported but is deprecated, and it&#8217;s advised that you migrate to the new syntax.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Old vs. new syntax</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Old</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">New</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plain variable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.my-env-var.value=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.vars.my-env-var=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">From field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.my-env-var.field=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.fields.my-env-var=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">All from <code>ConfigMap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.xxx.configmap=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.configmaps=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">All from <code>Secret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.xxx.secret=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.secrets=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">From one <code>Secret</code> field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.foo.secret=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.mapping.foo.from-secret=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.foo.value=field</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.mapping.foo.with-key=field</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">From one <code>ConfigMap</code> field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.foo.configmap=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.mapping.foo.from-configmap=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env-vars.foo.value=field</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.openshift.env.mapping.foo.with-key=field</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you redefine the same variable using the new syntax while keeping the old syntax, <strong>ONLY</strong> the new version will be kept, and a warning will be issued to alert you of the problem. For example, if you define both <code>quarkus.openshift.env-vars.my-env-var.value=foobar</code> and <code>quarkus.openshift.env.vars.my-env-var=newValue</code>, the extension will only generate an environment variable <code>MY_ENV_VAR=newValue</code> and issue a warning.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mounting-volumes"><a class="anchor" href="#mounting-volumes"></a>Mounting volumes</h4>
<div class="paragraph">
<p>The OpenShift extension allows the user to configure both volumes and mounts for the application.</p>
</div>
<div class="paragraph">
<p>Any volume can be mounted with a simple configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.mounts.my-volume.path=/where/to/mount</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add a mount to my pod for volume <code>my-volume</code> to path <code>/where/to/mount</code></p>
</div>
<div class="paragraph">
<p>The volumes themselves can be configured as shown in the sections below:</p>
</div>
<div class="sect4">
<h5 id="secret-volumes"><a class="anchor" href="#secret-volumes"></a>Secret volumes</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.secret-volumes.my-volume.secret-name=my-secret</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configmap-volumes"><a class="anchor" href="#configmap-volumes"></a>ConfigMap volumes</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.config-map-volumes.my-volume.config-map-name=my-secret</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="knative-openshift-serverless"><a class="anchor" href="#knative-openshift-serverless"></a>Knative - OpenShift Serverless</h3>
<div class="paragraph">
<p>OpenShift also provides the ability to use Knative via the <a href="https://www.openshift.com/learn/topics/serverless">OpenShift Serverless</a> functionality.</p>
</div>
<div class="paragraph">
<p>The first order of business is to instruct Quarkus to generate Knative resources by setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.deployment-target=knative</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to leverage OpenShift S2I to build the container image on the cluster and use the resulting container image for the Knative application, we need to set a couple of configuration properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># set the Kubernetes namespace which will be used to run the application
quarkus.container-image.group=geoand
# set the container image registry - this is the standard URL used to refer to the internal OpenShift registry
quarkus.container-image.registry=image-registry.openshift-image-registry.svc:5000</code></pre>
</div>
</div>
<div class="paragraph">
<p>The application can then be deployed to OpenShift Serverless by enabling the standard <code>quarkus.kubernetes.deploy=true</code> property.</p>
</div>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus是开放的。这个项目的所有依赖关系在<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>许可或者可以在有互换性的许可下使用。<br /><br />这个网站使用 <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> 来构建，代码托管于<a href='https://pages.github.com/' target='_blank'>Github Pages</a>，完全开源。当需要改善和丰富内容的时候，我们会从 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>网站项目</a>创建分支，然后修正并发布到网站。</p>

    
      <div class="width-1-12 project-links">
        <span>导航栏</span>
        <ul class="footer-links">
          
            <li><a href="/">主页</a></li>
          
            <li><a href="/about">关于Quarkus</a></li>
          
            <li><a href="/blog">博客</a></li>
          
            <li><a href="/insights">播客</a></li>
          
            <li><a href="/events">活动</a></li>
          
            <li><a href="/newsletter">新闻</a></li>
          
            <li><a href="/publications">发表</a></li>
          
            <li><a href="/awards">获奖</a></li>
          
            <li><a href="/security">安全</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>社交媒体</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Twitter</a></li>
          
            <li><a href="https://www.facebook.com/quarkusio">Facebook</a></li>
          
            <li><a href="https://www.linkedin.com/company/quarkusio/">Linkedin</a></li>
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg">Youtube</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>协助</span>
        <ul class="footer-links">
          
            <li><a href="/support">支持</a></li>
          
            <li><a href="/guides">指南</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">入门</a></li>
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions">讨论</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">开发邮件列表</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
            <li><a href="https://quarkus.io/">English</a></li>
          
            <li><a href="https://es.quarkus.io/">Español</a></li>
          
            <li><a href="https://ja.quarkus.io/">日本語</a></li>
          
            <li><a href="https://cn.quarkus.io/">简体中文</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus由社区项目组成：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">更多...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
</body>

</html>
